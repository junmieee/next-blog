---
title: Redux-thunkì™€ Redux-saga ì´í•´í•˜ê¸°
date: 2022-12-24
description: Redux-thunkì™€ Redux-saga
thumbnail: 'images/posts/blog/Redux-thunk.webp
tags: 
  - Redux-thunk
  - Redux-saga
draft: false

---
![](https://velog.velcdn.com/images/junmieee_/post/3d65bd7b-029f-4883-b82b-aac191638178/image.webp)


_ì´ í¬ìŠ¤íŠ¸ëŠ” ì¸í”„ëŸ°ì˜ ZeroChoië‹˜ì˜ Nobird í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° Redux ë¯¸ë“¤ì›¨ì–´ë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œ ì •ë¦¬í•œ ë‚´ìš©ìž…ë‹ˆë‹¤ . _

> ðŸ· Redux-sagaì™€ Redux-thunkëŠ” Redux ë¯¸ë“¤ì›¨ì–´ë¡œì„œ, **ë¹„ë™ê¸° ìž‘ì—…**ì„ ì²˜ë¦¬í•  ìˆ˜ ìžˆê²Œ í•˜ê³  Redux Actionì„ í•¸ë“¤ë§í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.

# ðŸ’¡Redux-thunk
Redux-thunkëŠ” Reduxê°€ ë¹„ë™ê¸° ì•¡ì…˜ì„ dispatchí•  ìˆ˜ ìžˆê²Œ ë„ì™€ì£¼ëŠ” ë¯¸ë“¤ì›¨ì–´ì´ë‹¤.ê¸°ë³¸ì ìœ¼ë¡œ ReduxëŠ” ì•¡ì…˜ê°ì²´ë§Œì„ dispatchí•  ìˆ˜ ìžˆì§€ë§Œ redux-thunkë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° ìž‘ì—…ì„ ì²˜ë¦¬í•˜ë©´, ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ë¥¼ ì¼ë°˜ í•¨ìˆ˜ ëŒ€ì‹  í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¡œ ë§Œë“¤ ìˆ˜ ìžˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¹„ë™ê¸° ìž‘ì—…ì„ ì²˜ë¦¬í•˜ê³ , ê²°ê³¼ì— ë”°ë¼ ë‹¤ë¥¸ ì•¡ì…˜ì„ dispatch í•  ìˆ˜ ìžˆë‹¤. 

âœ“ ì¼ë°˜ì ìœ¼ë¡œ Redux ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
```
export const loadMyInfoRequest = () => ({
  type: 'LOAD_MY_INFO_REQUEST'
});

```

âœ“ Redux-thunkë¥¼ ì‚¬ìš©í•˜ë©´, ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¡œ ë³€ê²½í•  ìˆ˜ ìžˆë‹¤. loadMyInfo í•¨ìˆ˜ëŠ” dispatch í•¨ìˆ˜ë¥¼ ì¸ìžë¡œ ë°›ê³ , 1ì´ˆ í›„ì— LOAD_MY_INFO_REQUEST ì•¡ì…˜ì„ dispatch í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸° ìž‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìžˆê²Œ ëœë‹¤.

```
export const loadMyInfo = () => (dispatch) => {
  setTimeout(() => {
    dispatch(loadMyInfoRequest());
  }, 1000);
};
```


#### â˜ðŸ¿ ì•„ëž˜ëŠ” Nobird í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° redux-thunkë¥¼ ì ìš©í•œ ì½”ë“œì˜ ì¼ë¶€ìž„.
---

> npm i redux-thunk

ì•„ëž˜ì™€ ê°™ì´ Redux-thunk ë¯¸ë“¤ì›¨ì–´ë¥¼ Storeì—ì„œ ë°°ì—´ì— ì¶”ê°€í•´ì£¼ë©´ applyMiddlewareì˜ ì¸ìžë¡œ ë“¤ì–´ê°€ê²Œ ëœë‹¤. 
```
//configureStore.js

import { applyMiddleware, createStore, compose } from 'redux';
import thunkMiddleware from 'redux-thunk'; // redux-thunk ë¯¸ë“¤ì›¨ì–´ import
import { createWrapper } from 'next-redux-wrapper';
import { composeWithDevTools } from 'redux-devtools-extension';

import reducer from '../reducers';


const configureStore = () => {
  const middlewares = [thunkMiddleware]; // redux-thunk ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€
  const enhancer =
    process.env.NODE_ENV === 'production'
      ? compose(applyMiddleware(...middlewares))
      : composeWithDevTools(applyMiddleware(...middlewares));
  const store = createStore(reducer, enhancer);
  return store;
};

const wrapper = createWrapper(configureStore, {
  debug: process.env.NODE_ENV === 'development',
});

export default wrapper;
```

Stateì˜ ì´ˆê¸° ìƒíƒœë¥¼ ì •ì˜í•´ ì¤€ë‹¤. 

```
export const initialState = {
    loadMyInfoLoading: false, // ìœ ì € ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹œë„
    loadMyInfoDone: false,
    loadMyInfoError: null,
    }
```

action íƒ€ìž…ì„ ì •ì˜í•´ì¤€ í›„ ì•¡ì…˜ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ì—¬ **LOAD_MY_INFO_REQUEST** ì•¡ì…˜ì„ dispatch í•œ í›„, API ìš”ì²­ì„ ë³´ë‚´ê³  ìš”ì²­ì´ ì„±ê³µí•˜ë©´ **LOAD_MY_INFO_SUCCESS** ì•¡ì…˜ì„, ì‹¤íŒ¨í•˜ë©´ **LOAD_MY_INFO_FAILURE** ì•¡ì…˜ì„ dispatch í•˜ë„ë¡ êµ¬í˜„í•˜ì˜€ë‹¤. 

```
//ì•¡ì…˜ íƒ€ìž… ì •ì˜
export const LOAD_MY_INFO_REQUEST = 'LOAD_MY_INFO_REQUEST';
export const LOAD_MY_INFO_SUCCESS = 'LOAD_MY_INFO_SUCCESS';
export const LOAD_MY_INFO_FAILURE = 'LOAD_MY_INFO_FAILURE';


// ì•¡ì…˜ ìƒì„± í•¨ìˆ˜
export const loadMyInfo = () => {
  return async (dispatch) => {
    dispatch({ type: LOAD_MY_INFO_REQUEST });
    try {
      const response = await fetch('/api/myinfo');
      const data = await response.json();
      dispatch({ type: LOAD_MY_INFO_SUCCESS, data });
    } catch (error) {
      dispatch({ type: LOAD_MY_INFO_FAILURE, error });
    }
  };
};


//ë¦¬ë“€ì„œ
const reducer = (state = initialState, action) => {
    switch (action.type) {
        case LOAD_MY_INFO_REQUEST:
            return {
                ...state,
                loadMyInfoLoading: true,
                loadMyInfoError: null,
                loadMyInfoDone: false,
            };
        case LOAD_MY_INFO_SUCCESS:
            return {
                ...state,
                loadMyInfoLoading: false,
                me: action.data,
                loadMyInfoDone: true,
            };
        case LOAD_MY_INFO_FAILURE:
            return {
                ...state,
                loadMyInfoLoading: false,
                loadMyInfoError: action.error,
            };
        default:
            return state;
    }
};


```

---

# ðŸ’¡Redux-saga

### ðŸ“Ž Generator 
Redux-sagaì—ì„œëŠ” generator(ì œë„¤ë ˆì´í„°) í•¨ìˆ˜ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤. ì œë„¤ë ˆì´í„° í•¨ìˆ˜ëŠ” ì¼ë°˜ì ì¸ í•¨ìˆ˜ì™€ëŠ” ë‹¬ë¦¬ ì‹¤í–‰ ì¤‘ ë©ˆì¶œ ìˆ˜ ìžˆê³  ê²°ê³¼ê°’ì„ ì—¬ëŸ¬ë²ˆ return í•  ìˆ˜ ìžˆë‹¤. 

ì•„ëž˜ì™€ ê°™ì´ yieldë¥¼ í†µí•´ ì‹¤í–‰ì„ ë©ˆì¶œ ìˆ˜ ìžˆë‹¤. ì œë„¤ë ˆì´í„° í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ nextí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼ í•œë‹¤.

```
const gen = function* () {
    console.log(1);
    yield;
    console.log(2);
    yield;
    console.log(3);
    yield;
    
}
 
 // ì‹¤í–‰ê²°ê³¼
 generator.next()
// {value: undefined, done: false}
generator.next()
// {value: undefined, done: false}
generator.next()
//{value: undefined, done: false}

```

### ðŸ“Ž Effect 
sagaì˜ effectëŠ” sagaê°€ ë¹„ë™ê¸° ìž‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆ ë°œìƒí•  ìˆ˜ ìžˆëŠ” ì—¬ëŸ¬ ê°€ì§€ ì‚¬ì´ë“œ ì´íŽ™íŠ¸(side effect)ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì´ë‹¤.ì¼ë°˜ì ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­, íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼, ë¸Œë¼ìš°ì € ì¿ í‚¤ ì„¤ì • ë“±ê³¼ ê°™ì€ ìž‘ì—…ì„ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©í•œë‹¤.

ì•„ëž˜ëŠ” sagaë¥¼ ì‚¬ìš©í•œ ì½”ë“œ ì˜ˆì‹œì´ë‹¤. 
* ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— sagasë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ì–´ ë†“ê³  ì§„í–‰í–ˆë‹¤. 


--- 

loadMyInfoAPI í•¨ìˆ˜ë¥¼ í†µí•´ /user ì£¼ì†Œë¡œ GET ìš”ì²­ì„ ë³´ë‚´ì„œ ì‚¬ìš©ìž ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” APIë¥¼ í˜¸ì¶œí•œë‹¤.

loadMyInfo í•¨ìˆ˜ëŠ” loadMyInfoAPI í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‚¬ê°€ ì œë„¤ë ˆì´í„°(generator) í•¨ìˆ˜ì´ë‹¤. ì´ í•¨ìˆ˜ëŠ” Redux-Sagaì—ì„œ ì‚¬ìš©ë˜ëŠ” íŠ¹ìˆ˜í•œ ë¬¸ë²•ì¸ **`yield`** ë¥¼ ì‚¬ìš©í•˜ì—¬ loadMyInfoAPI í•¨ìˆ˜ê°€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„ì— ê²°ê³¼ë¥¼ ë°›ì•„ì˜¨ë‹¤.

**`put`** ì„ ì‚¬ìš©í•˜ì—¬ Redux storeì— ì•¡ì…˜ì„ dispatchí•œë‹¤(putì´ ispatchì˜ ê¸°ëŠ¥ì„ í•œë‹¤ê³  ë³´ë©´ ë¨). type ì†ì„±ì—ëŠ” ì•¡ì…˜ íƒ€ìž…ì´, data ì†ì„±ì—ëŠ” loadMyInfoAPIì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ê°€ ì „ë‹¬ëœë‹¤. 

watchLoadMyInfo í•¨ìˆ˜ëŠ” LOAD_MY_INFO_REQUEST ì•¡ì…˜ì´ ë°œìƒí•  ë•Œë§ˆë‹¤ loadMyInfo í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì—­í• ì„ í•œë‹¤. **`takeLatest`** ëŠ” ê°€ìž¥ ìµœê·¼ì— ë°œìƒí•œ ì•¡ì…˜ë§Œ ì²˜ë¦¬í•˜ê³ , ì´ì „ì— ì§„í–‰ ì¤‘ì¸ ìž‘ì—…ì€ ì·¨ì†Œí•˜ëŠ” í•¨ìˆ˜ë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¤‘ë³µ ìš”ì²­ì„ ë°©ì§€í•˜ê³ , ìµœì‹  ë°ì´í„°ë§Œ ë°›ì•„ì˜¬ ìˆ˜ ìžˆë„ë¡ í•œë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ, userSaga í•¨ìˆ˜ì—ì„œ **`all`** ê³¼ **`fork`** ë¥¼ ì‚¬ìš©í•˜ì—¬ watchLoadMyInfo í•¨ìˆ˜ë¥¼ í¬í•¨í•œ ì—¬ëŸ¬ ì‚¬ê°€ í•¨ìˆ˜ë“¤ì„ **`ë™ì‹œì—`** ì‹¤í–‰í•œë‹¤. ì´ë¥¼ í†µí•´ ì—¬ëŸ¬ ê°œì˜ API ìš”ì²­ì„ ë³‘ë ¬ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìžˆë‹¤.

```
//sagas > user.js

function loadMyInfoAPI() {
    return axios.get('/user'); // GET(Browser)
}

function* loadMyInfo() {
    try {
        const result = yield call(loadMyInfoAPI);
        console.log(result);
        yield put({
            type: LOAD_MY_INFO_SUCCESS,
            data: result.data,
        });
    } catch (err) {
        console.error(err);
        yield put({
            type: LOAD_MY_INFO_FAILURE,
            error: err.response.data,
        });
    }
}

function* watchLoadMyInfo() {
    yield takeLatest(LOAD_MY_INFO_REQUEST, loadMyInfo);
}


export default function* userSaga() {
    yield all([
       	...
        fork(watchLoadMyInfo),
		...

    ])
}
```

